import{M as p}from"./modal-4fddf2a5.js";import{_ as u,o as c,b as n,d as e,t as s,n as g,F as O,h as v,g as A,i as m,p as M,q as w,m as k,a as T,r as _,e as h}from"./index-e0ab1567.js";import{P as D}from"./PagePagination-c9a3af59.js";const I={props:["selectOrder"],data(){return{user:{},create_at:""}},watch:{selectOrder(){const t={...this.selectOrder};this.user=t.user,this.create_at=this.switchDate(this.selectOrder.create_at)}},methods:{switchDate(t){return new Date(t*1e3).toISOString().slice(0,10)}}},V={class:"modal-dialog modal-xl"},E={class:"modal-content"},L=e("div",{class:"modal-header bg-secondary"},[e("h5",{class:"modal-title text-white",id:"exampleModalLabel"},"訂單詳情"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),S={class:"modal-body"},C={class:"row"},B={class:"col-6"},H={class:"row g-3"},N={class:"col-12"},j=e("label",{for:"order_id",class:"form-label"},"訂單編號",-1),R={class:"form-control"},q={class:"col-6"},U=e("label",{for:"order_date",class:"form-label"},"訂購日期",-1),z={class:"form-control"},F={class:"col-6"},Y=e("label",{class:"form-label"},"訂單總額",-1),W={class:"form-control"},G={class:"col-6"},J=e("label",{for:"order_name",class:"form-label"},"訂購大名",-1),K={class:"form-control"},Q={class:"col-6"},X=e("label",{for:"order_phone",class:"form-label"},"聯絡電話",-1),Z={class:"form-control"},ee={class:"col-12"},te=e("label",{for:"order_email",class:"form-label"},"電子信箱",-1),se={class:"form-control"},oe={class:"col-12"},ae=e("label",{class:"form-label"},"顧客留言",-1),de={class:"form-control"},le={class:"col-6"},re=e("label",{for:"order_pay",class:"form-label"},"付款方式",-1),ce={class:"form-control"},ne={class:"col-6"},ie=e("label",{class:"form-label"},"付款狀態",-1),_e={class:"col-6"},he=e("p",{class:"form-label"},"購買明細",-1),me={class:"row g-0"},ue=e("div",{class:"col-2 d-flex align-items-center justify-content-center border-end border-1 border-primary"},[e("span",null,"1")],-1),be={class:"col-10"},pe={class:"card-body"},fe={class:"card-title fw-bold ellipsis2"},ge={class:"mb-2"},Oe={class:"d-flex justify-content-between align-items-center"},ve={class:"text-muted"},Pe={key:0},ye={class:"fs-7 text-secondary"},$e={class:"fs-5 fw-bold ms-1 text-black"};function xe(t,o,l,b,a,i){return c(),n("div",V,[e("div",E,[L,e("div",S,[e("div",C,[e("div",B,[e("div",H,[e("div",N,[j,e("p",R,s(l.selectOrder.id),1)]),e("div",q,[U,e("p",z,s(a.create_at),1)]),e("div",F,[Y,e("p",W,s(a.user.cartTotal),1)]),e("div",G,[J,e("p",K,s(a.user.name),1)]),e("div",Q,[X,e("p",Z,s(a.user.tel),1)]),e("div",ee,[te,e("p",se,s(a.user.email),1)]),e("div",oe,[ae,e("p",de,s(l.selectOrder.message?l.selectOrder.message:"沒有留言"),1)]),e("div",le,[re,e("p",ce,s(a.user.pay),1)]),e("div",ne,[ie,e("p",{class:g(["form-control",{"text-danger":!l.selectOrder.is_paid}])},s(l.selectOrder.is_paid?"已付款":"未付款"),3)])])]),e("div",_e,[he,e("ul",null,[(c(!0),n(O,null,v(l.selectOrder.products,d=>(c(),n("li",{class:"card mb-3",key:d.id},[e("div",me,[ue,e("div",be,[e("div",pe,[e("h5",fe,s(d.product.title),1),e("p",ge,"使用日期："+s(d.date),1),e("div",Oe,[e("ul",ve,[e("li",null,s(d.product.ticketA)+" x "+s(d.ticketA_qty),1),d.product.ticketB?(c(),n("li",Pe,s(d.product.ticketB)+" x "+s(d.ticketB_qty),1)):A("",!0)]),e("p",ye,[m(" TWD"),e("span",$e,s(d.cartItemTotal),1)])])])])])]))),128))])])])])])])}const Ae=u(I,[["render",xe]]),{VITE_APP_API:Me,VITE_APP_PATH:we}={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"amberhh",BASE_URL:"/HH-STAY/",MODE:"production",DEV:!1,PROD:!0},f=M("adminOderStore",{state:()=>({orders:[],pages:{},isLoading:!1}),actions:{getOrder(t=1){this.isLoading=!0,w.get(`${Me}v2/api/${we}/admin/orders/?page=${t}`).then(o=>{this.orders=o.data.orders,this.pages=o.data.pagination,this.isLoading=!1}).catch(o=>{alert(o.response.data.message)})}}}),ke={props:["selectOrder","deleteOrder"],data(){return{userName:""}},watch:{selectOrder(){const t={...this.selectOrder};this.userName=t.user.name}}},Te={class:"modal-dialog"},De={class:"modal-content border-0"},Ie=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delProductModalLabel",class:"modal-title"},[e("span",null,"刪除訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ve={class:"modal-body"},Ee={class:"text-danger"},Le=e("br",null,null,-1),Se={class:"modal-footer"},Ce=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Be(t,o,l,b,a,i){return c(),n("div",Te,[e("div",De,[Ie,e("div",Ve,[m(" 是否要刪除顧客： "),e("strong",Ee,s(a.userName),1),m(" 的訂單"),Le,m("刪除後將無法恢復哦！ ")]),e("div",Se,[Ce,e("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=(...d)=>l.deleteOrder&&l.deleteOrder(...d))}," 確認刪除 ")])])])}const He=u(ke,[["render",Be]]),{VITE_APP_API:Ne,VITE_APP_PATH:je}={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"amberhh",BASE_URL:"/HH-STAY/",MODE:"production",DEV:!1,PROD:!0},Re={data(){return{color:"#ffdf65",fullPage:!1,selectOrder:"",orderModal:"",deleteOrderModal:""}},computed:{...k(f,["orders","pages","isLoading"])},methods:{...T(f,["getOrder"]),openModal(t,o){t==="check"?(this.orderModal.show(),this.selectOrder={...o}):t==="delete"&&(this.selectOrder={...o},this.deleteOrderModal.show())},deleteOrder(){const t=this.selectOrder.id;this.$http.delete(`${Ne}v2/api/${je}/admin/order/${t}`).then(o=>{alert(o.data.message),this.getOrder(),this.deleteOrderModal.hide()}).catch(o=>{alert(o.response.data.message),this.deleteOrderModal.hide()})},switchDate(t){return new Date(t*1e3).toISOString().slice(0,10)}},components:{OrderModal:Ae,DeleteOrderModal:He,PagePagination:D},mounted(){const t=document.cookie.replace(/(?:(?:^|.*;\s*)hexschool\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=t,this.getOrder(),this.orderModal=new p(this.$refs.orderModal,{keyboard:!1}),this.deleteOrderModal=new p(this.$refs.deleteOrderModal,{keyboard:!1})}},qe={class:"container p-3 position-relative"},Ue={class:"modal fade",tabindex:"-1","aria-hidden":"true",ref:"orderModal"},ze={class:"modal fade",tabindex:"-1","aria-hidden":"true",ref:"deleteOrderModal"},Fe=e("h2",{class:"fs-3 mb-2"},"訂單列表",-1),Ye={class:"table table-hover mb-3"},We=e("thead",{class:"bg-primary text-dark"},[e("tr",null,[e("th",{width:"120"},"訂單日期"),e("th",{width:"120"},"訂單編號"),e("th",{width:"100"},"訂購大名"),e("th",{width:"100",class:"text-center"},"訂單金額"),e("th",{width:"80",class:"text-center"},"付款狀態"),e("th",{width:"80",class:"text-center"},"訂單詳情")])],-1),Ge={class:"text-end pe-5"},Je={class:"text-center"},Ke={class:"text-center"},Qe={class:"btn-group",role:"group","aria-label":"Basic mixed styles example"},Xe=["onClick"],Ze=["onClick"];function et(t,o,l,b,a,i){const d=_("VeeLoading"),P=_("OrderModal"),y=_("DeleteOrderModal"),$=_("PagePagination");return c(),n("div",qe,[h(d,{active:t.isLoading,"onUpdate:active":o[0]||(o[0]=r=>t.isLoading=r),color:a.color,"is-full-page":a.fullPage},null,8,["active","color","is-full-page"]),e("div",Ue,[h(P,{selectOrder:a.selectOrder},null,8,["selectOrder"])],512),e("div",ze,[h(y,{selectOrder:a.selectOrder,deleteOrder:i.deleteOrder},null,8,["selectOrder","deleteOrder"])],512),Fe,e("table",Ye,[We,e("tbody",null,[(c(!0),n(O,null,v(t.orders,r=>(c(),n("tr",{key:r.id,class:g({"table-primary":r.is_paid})},[e("td",null,s(i.switchDate(r.create_at)),1),e("td",null,s(r.id),1),e("td",null,s(r.user.name),1),e("td",Ge,s(r.user.cartTotal),1),e("td",Je,s(r.is_paid?"已付款":"未付款"),1),e("td",Ke,[e("div",Qe,[e("button",{type:"button",class:"btn btn-outline-secondary border-left-0",onClick:x=>i.openModal("check",r)}," 查看 ",8,Xe),e("button",{type:"button",class:"btn btn-outline-danger",onClick:x=>i.openModal("delete",r)}," 刪除 ",8,Ze)])])],2))),128))])]),h($,{pages:t.pages,renderData:t.getOrder},null,8,["pages","renderData"])])}const at=u(Re,[["render",et]]);export{at as default};
