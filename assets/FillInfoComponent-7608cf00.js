import{m as y,a as P,_ as $,c as _,o as r,b as m,d as e,F as w,h as E,t as l,g as f,i as p,r as u,e as n,K as S,f as T,w as V,n as v,G as B,H as D}from"./index-f7dc4ea1.js";const C={computed:{...y(_,["carts","cartLength","cartTotal"])},methods:{...P(_,["getCartList"])}},H={class:"col-lg-7"},O=e("p",{class:"mb-2"},"購物明細",-1),L={class:"row g-0"},U={class:"col-2 d-flex align-items-center justify-content-center border-end border-1 border-primary"},M={class:"col-10"},N={class:"card-body"},F={class:"card-title fw-bold ellipsis2"},j={class:"mb-2"},R={class:"d-flex justify-content-between align-items-center"},q={class:"text-muted"},W={key:0},Y={class:"fs-7 text-secondary"},z={class:"fs-5 fw-bold ms-1 text-black"},G={class:"row justify-content-end"},K={class:"col-lg-5 text-end"},J={class:"mb-3"};function Q(t,s,c,A,o,h){return r(),m("div",H,[O,e("ul",null,[(r(!0),m(w,null,E(t.carts.carts,(a,d)=>(r(),m("li",{class:"card mb-3",key:a.id},[e("div",L,[e("div",U,[e("span",null,l(d+1),1)]),e("div",M,[e("div",N,[e("h5",F,l(a.product.title),1),e("p",j,"使用日期："+l(a.date),1),e("div",R,[e("ul",q,[e("li",null,l(a.product.ticketA)+" x "+l(a.ticketA_qty),1),a.product.ticketB?(r(),m("li",W,l(a.product.ticketB)+" x "+l(a.ticketB_qty),1)):f("",!0)]),e("p",Y,[p(" TWD"),e("span",z,l(a.cartItemTotal),1)])])])])])]))),128))]),e("div",G,[e("div",K,[e("div",J,[e("span",null,l(t.cartLength)+"件商品",1),e("span",null,"總共"+l(t.cartTotal)+"元",1)])])])])}const X=$(C,[["render",Q]]),{VITE_APP_API:Z,VITE_APP_PATH:ee}={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"amberhh",BASE_URL:"/HH-STAY/",MODE:"production",DEV:!1,PROD:!0},se={props:["user","message","orderId"],computed:{...y(_,["orderStatus"])},methods:{...P(_,["changeStatus","showAlert"]),pay(t){this.$http.post(`${Z}v2/api/${ee}/pay/${t}`).then(()=>{this.changeStatus("finish"),this.$router.push("/cart/finish")}).catch(s=>{alert(s.response.data.message)})}}},te=e("div",{class:"mb-3"},[e("p",null,"訂購資訊")],-1),oe={class:"mb-3"},ae={class:"mb-3"},le={class:"mb-3"},ne={class:"mb-3"},re={key:0,class:"mb-3"},ce={class:"d-flex justify-content-end"},de={class:"w-50"};function ie(t,s,c,A,o,h){const a=u("AlertWindow");return r(),m(w,null,[n(a),e("form",null,[te,e("div",oe,[e("p",null,"訂購大名："+l(c.user.name),1)]),e("div",ae,[e("p",null,"手機號碼："+l(c.user.tel),1)]),e("div",le,[e("p",null,"電子信箱："+l(c.user.email),1)]),e("div",ne,[e("p",null,"付款方式："+l(c.user.pay),1)]),c.message?(r(),m("div",re,[e("p",null,"備註留言："+l(c.message),1)])):f("",!0),e("ul",ce,[e("li",de,[e("button",{type:"button",class:"btn btn-primary text-dark w-100",onClick:s[0]||(s[0]=d=>h.pay(c.orderId))}," 確認付款 ")])])])],64)}const ue=$(se,[["render",ie]]),{VITE_APP_API:me,VITE_APP_PATH:_e}={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"amberhh",BASE_URL:"/HH-STAY/",MODE:"production",DEV:!1,PROD:!0},he={props:["cartTotal"],data(){return{user:{cartTotal:null,email:"",name:"",tel:"",pay:"",address:"不需要地址"},message:"",orderId:null}},computed:{...y(_,["orderStatus"])},methods:{...P(_,["getCartList","changeStatus","getUserEmail","showAlert"]),isPhone(t){return/^(09)[0-9]{8}$/.test(t)?!0:"需要正確的手機號碼"},onSubmit(){const t={user:this.user,message:this.message};this.$http.post(`${me}v2/api/${_e}/order`,{data:t}).then(s=>{this.orderId=s.data.orderId,this.showAlert(s.data.message,!1,"success"),this.getUserEmail(this.user.email),this.changeStatus("pay")}).catch(s=>{alert(s.response.data.message)})}},components:{ErrorMessage:S,OrderEstablished:ue},mounted(){this.user.cartTotal=this.cartTotal}},pe={class:"col-lg-5"},fe={class:"mb-3"},be=e("label",{for:"orderName",class:"form-label"},[p("訂購大名"),e("span",{class:"ms-1 text-danger"},"*")],-1),ge={class:"mb-3"},ve=e("label",{for:"orderPhone",class:"form-label"},[p("手機號碼"),e("span",{class:"ms-1 text-danger"},"*")],-1),ye={class:"mb-3"},Pe=e("label",{for:"email",class:"form-label"},[p("電子信箱"),e("span",{class:"ms-1 text-danger"},"*")],-1),$e={class:"mb-3"},Ae=e("label",{for:"orderPay",class:"form-label"},[p("付款方式"),e("span",{class:"ms-1 text-danger"},"*")],-1),Ve=e("option",{value:"",selected:"",disabled:"",class:"text-muted"}," 請選擇付款方式 ",-1),Te=e("option",{value:"信用卡"},"信用卡",-1),we=e("option",{value:"超商代碼"},"超商代碼",-1),Ie=e("option",{value:"行動支付"},"行動支付",-1),ke=e("option",{value:"銀行轉帳"},"銀行轉帳",-1),xe={class:"mb-3"},Ee=e("label",{for:"orderMessage",class:"form-label"},"備註留言",-1),Se={class:"d-flex justify-content-end"},Be={class:"me-2 w-50"},De=e("li",{class:"w-50"},[e("button",{type:"submit",class:"btn btn-primary text-dark w-100"}," 送出訂單 ")],-1);function Ce(t,s,c,A,o,h){const a=u("AlertWindow"),d=u("VField"),b=u("ErrorMessage"),I=u("RouterLink"),k=u("VForm"),x=u("OrderEstablished");return r(),m(w,null,[n(a),e("div",pe,[t.orderStatus==="fillInfo"?(r(),T(k,{key:0,ref:"form",onSubmit:h.onSubmit},{default:V(({errors:g})=>[e("div",fe,[be,n(d,{id:"orderName",name:"姓名",type:"text",class:v(["form-control shadow-sm",{"is-invalid":g.姓名}]),placeholder:"請輸入訂購者姓名",rules:"required",modelValue:o.user.name,"onUpdate:modelValue":s[0]||(s[0]=i=>o.user.name=i)},null,8,["class","modelValue"]),n(b,{name:"姓名",class:"invalid-feedback"})]),e("div",ge,[ve,n(d,{id:"orderPhone",name:"手機號碼",type:"tel",class:v(["form-control",{"is-invalid":g.手機號碼}]),placeholder:"請輸入手機號碼 ex: 0912345678",rules:h.isPhone,modelValue:o.user.tel,"onUpdate:modelValue":s[1]||(s[1]=i=>o.user.tel=i)},null,8,["class","rules","modelValue"]),n(b,{name:"手機號碼",class:"invalid-feedback"})]),e("div",ye,[Pe,n(d,{id:"email",name:"電子信箱",type:"email",class:v(["form-control shadow-sm",{"is-invalid":g.電子信箱}]),placeholder:"請輸入電子信箱",rules:"email|required",modelValue:o.user.email,"onUpdate:modelValue":s[2]||(s[2]=i=>o.user.email=i)},null,8,["class","modelValue"]),n(b,{name:"電子信箱",class:"invalid-feedback"})]),e("div",$e,[Ae,n(d,{class:v(["form-select shadow-sm",{"is-invalid":g.付款方式}]),id:"orderPay",modelValue:o.user.pay,"onUpdate:modelValue":s[3]||(s[3]=i=>o.user.pay=i),name:"付款方式",rules:"required",as:"select"},{default:V(()=>[Ve,Te,we,Ie,ke]),_:2},1032,["modelValue","class"]),n(b,{name:"付款方式",class:"invalid-feedback"})]),e("div",xe,[Ee,B(e("textarea",{id:"orderMessage",class:"form-control shadow-sm",cols:"30",rows:"10","onUpdate:modelValue":s[4]||(s[4]=i=>o.message=i),placeholder:"有什麼想和我們說的嗎"},null,512),[[D,o.message]])]),e("ul",Se,[e("li",Be,[n(I,{to:"/cart",class:"btn btn-outline-primary text-dark w-100"},{default:V(()=>[p("修改訂單")]),_:1})]),De])]),_:1},8,["onSubmit"])):f("",!0),t.orderStatus==="pay"?(r(),T(x,{key:1,user:o.user,message:o.message,orderId:o.orderId},null,8,["user","message","orderId"])):f("",!0)])],64)}const He=$(he,[["render",Ce]]),Oe={components:{OrderDetail:X,BuyerComponent:He},computed:{...y(_,["orderStatus","cartTotal"])},methods:{...P(_,["changeStatus"])},mounted(){this.changeStatus("fillInfo")}},Le={class:"container mb-3 mb-lg-5"},Ue={class:"row justify-content-center g-5"};function Me(t,s,c,A,o,h){const a=u("OrderDetail"),d=u("BuyerComponent");return r(),m("section",Le,[e("div",Ue,[t.orderStatus!=="finish"?(r(),T(a,{key:0})):f("",!0),n(d,{cartTotal:t.cartTotal},null,8,["cartTotal"])])])}const Fe=$(Oe,[["render",Me]]);export{Fe as default};
