import{M as p}from"./modal-f4ee6743.js";import{_ as u,o as c,b as n,d as e,t as s,n as O,F as g,h as v,g as $,i as m,m as k,a as P,r as _,e as h}from"./index-f35bbac0.js";import{a as f}from"./adminOrderStore-270f2e8f.js";import{P as D}from"./PagePagination-67baa66b.js";import"./base-component-77c943e8.js";const A={props:["selectOrder"],data(){return{user:{},create_at:""}},watch:{selectOrder(){const t={...this.selectOrder};this.user=t.user,this.create_at=this.switchDate(this.selectOrder.create_at)}},methods:{switchDate(t){return new Date(t*1e3).toISOString().slice(0,10)}}},T={class:"modal-dialog modal-xl"},V={class:"modal-content"},C=e("div",{class:"modal-header bg-secondary"},[e("h5",{class:"modal-title text-white",id:"exampleModalLabel"},"訂單詳情"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),I={class:"modal-body"},L={class:"row"},S={class:"col-6"},B={class:"row g-3"},E={class:"col-12"},N=e("label",{for:"order_id",class:"form-label"},"訂單編號",-1),j={class:"form-control"},H={class:"col-6"},q=e("label",{for:"order_date",class:"form-label"},"訂購日期",-1),z={class:"form-control"},F={class:"col-6"},R=e("label",{class:"form-label"},"訂單總額",-1),U={class:"form-control"},W={class:"col-6"},Y=e("label",{for:"order_name",class:"form-label"},"訂購大名",-1),G={class:"form-control"},J={class:"col-6"},K=e("label",{for:"order_phone",class:"form-label"},"聯絡電話",-1),Q={class:"form-control"},X={class:"col-12"},Z=e("label",{for:"order_email",class:"form-label"},"電子信箱",-1),ee={class:"form-control"},te={class:"col-12"},se=e("label",{class:"form-label"},"顧客留言",-1),oe={class:"form-control"},le={class:"col-6"},de=e("label",{for:"order_pay",class:"form-label"},"付款方式",-1),ae={class:"form-control"},re={class:"col-6"},ce=e("label",{class:"form-label"},"付款狀態",-1),ne={class:"col-6"},ie=e("p",{class:"form-label"},"購買明細",-1),_e={class:"row g-0"},he=e("div",{class:"col-2 d-flex align-items-center justify-content-center border-end border-1 border-primary"},[e("span",null,"1")],-1),me={class:"col-10"},ue={class:"card-body"},be={class:"card-title fw-bold ellipsis2"},pe={class:"mb-2"},fe={class:"d-flex justify-content-between align-items-center"},Oe={class:"text-muted"},ge={key:0},ve={class:"fs-7 text-secondary"},ye={class:"fs-5 fw-bold ms-1 text-black"};function xe(t,o,a,b,l,i){return c(),n("div",T,[e("div",V,[C,e("div",I,[e("div",L,[e("div",S,[e("div",B,[e("div",E,[N,e("p",j,s(a.selectOrder.id),1)]),e("div",H,[q,e("p",z,s(l.create_at),1)]),e("div",F,[R,e("p",U,s(l.user.cartTotal),1)]),e("div",W,[Y,e("p",G,s(l.user.name),1)]),e("div",J,[K,e("p",Q,s(l.user.tel),1)]),e("div",X,[Z,e("p",ee,s(l.user.email),1)]),e("div",te,[se,e("p",oe,s(a.selectOrder.message?a.selectOrder.message:"沒有留言"),1)]),e("div",le,[de,e("p",ae,s(l.user.pay),1)]),e("div",re,[ce,e("p",{class:O(["form-control",{"text-danger":!a.selectOrder.is_paid}])},s(a.selectOrder.is_paid?"已付款":"未付款"),3)])])]),e("div",ne,[ie,e("ul",null,[(c(!0),n(g,null,v(a.selectOrder.products,d=>(c(),n("li",{class:"card mb-3",key:d.id},[e("div",_e,[he,e("div",me,[e("div",ue,[e("h5",be,s(d.product.title),1),e("p",pe,"使用日期："+s(d.date),1),e("div",fe,[e("ul",Oe,[e("li",null,s(d.product.ticketA)+" x "+s(d.ticketA_qty),1),d.product.ticketB?(c(),n("li",ge,s(d.product.ticketB)+" x "+s(d.ticketB_qty),1)):$("",!0)]),e("p",ve,[m(" TWD"),e("span",ye,s(d.cartItemTotal),1)])])])])])]))),128))])])])])])])}const Me=u(A,[["render",xe]]),we={props:["selectOrder","deleteOrder"],data(){return{userName:""}},watch:{selectOrder(){const t={...this.selectOrder};this.userName=t.user.name}}},$e={class:"modal-dialog"},ke={class:"modal-content border-0"},Pe=e("div",{class:"modal-header bg-danger text-white"},[e("h5",{id:"delProductModalLabel",class:"modal-title"},[e("span",null,"刪除訂單")]),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),De={class:"modal-body"},Ae={class:"text-danger"},Te=e("br",null,null,-1),Ve={class:"modal-footer"},Ce=e("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ie(t,o,a,b,l,i){return c(),n("div",$e,[e("div",ke,[Pe,e("div",De,[m(" 是否要刪除顧客： "),e("strong",Ae,s(l.userName),1),m(" 的訂單"),Te,m("刪除後將無法恢復哦！ ")]),e("div",Ve,[Ce,e("button",{type:"button",class:"btn btn-danger",onClick:o[0]||(o[0]=(...d)=>a.deleteOrder&&a.deleteOrder(...d))}," 確認刪除 ")])])])}const Le=u(we,[["render",Ie]]),{VITE_APP_API:Se,VITE_APP_PATH:Be}={VITE_APP_API:"https://vue3-course-api.hexschool.io/",VITE_APP_PATH:"amberhh",BASE_URL:"/HH-STAY/",MODE:"production",DEV:!1,PROD:!0},Ee={data(){return{color:"#ffdf65",fullPage:!1,selectOrder:"",orderModal:"",deleteOrderModal:""}},computed:{...k(f,["orders","pages","isLoading"])},methods:{...P(f,["getOrder"]),openModal(t,o){t==="check"?(this.orderModal.show(),this.selectOrder={...o}):t==="delete"&&(this.selectOrder={...o},this.deleteOrderModal.show())},deleteOrder(){const t=this.selectOrder.id;this.$http.delete(`${Se}v2/api/${Be}/admin/order/${t}`).then(o=>{alert(o.data.message),this.getOrder(),this.deleteOrderModal.hide()}).catch(o=>{alert(o.response.data.message),this.deleteOrderModal.hide()})},switchDate(t){return new Date(t*1e3).toISOString().slice(0,10)}},components:{OrderModal:Me,DeleteOrderModal:Le,PagePagination:D},mounted(){const t=document.cookie.replace(/(?:(?:^|.*;\s*)hexschool\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=t,this.getOrder(),this.orderModal=new p(this.$refs.orderModal,{keyboard:!1}),this.deleteOrderModal=new p(this.$refs.deleteOrderModal,{keyboard:!1})}},Ne={class:"container p-3 position-relative"},je={class:"modal fade",tabindex:"-1","aria-hidden":"true",ref:"orderModal"},He={class:"modal fade",tabindex:"-1","aria-hidden":"true",ref:"deleteOrderModal"},qe=e("h2",{class:"fs-3 mb-2"},"訂單列表",-1),ze={class:"table table-hover mb-3"},Fe=e("thead",{class:"bg-primary text-dark"},[e("tr",null,[e("th",{width:"120"},"訂單日期"),e("th",{width:"120"},"訂單編號"),e("th",{width:"100"},"訂購大名"),e("th",{width:"100",class:"text-center"},"訂單金額"),e("th",{width:"80",class:"text-center"},"付款狀態"),e("th",{width:"80",class:"text-center"},"訂單詳情")])],-1),Re={class:"text-end pe-5"},Ue={class:"text-center"},We={class:"text-center"},Ye={class:"btn-group",role:"group","aria-label":"Basic mixed styles example"},Ge=["onClick"],Je=["onClick"];function Ke(t,o,a,b,l,i){const d=_("VeeLoading"),y=_("OrderModal"),x=_("DeleteOrderModal"),M=_("PagePagination");return c(),n("div",Ne,[h(d,{active:t.isLoading,"onUpdate:active":o[0]||(o[0]=r=>t.isLoading=r),color:l.color,"is-full-page":l.fullPage},null,8,["active","color","is-full-page"]),e("div",je,[h(y,{selectOrder:l.selectOrder},null,8,["selectOrder"])],512),e("div",He,[h(x,{selectOrder:l.selectOrder,deleteOrder:i.deleteOrder},null,8,["selectOrder","deleteOrder"])],512),qe,e("table",ze,[Fe,e("tbody",null,[(c(!0),n(g,null,v(t.orders,r=>(c(),n("tr",{key:r.id,class:O({"table-primary":r.is_paid})},[e("td",null,s(i.switchDate(r.create_at)),1),e("td",null,s(r.id),1),e("td",null,s(r.user.name),1),e("td",Re,s(r.user.cartTotal),1),e("td",Ue,s(r.is_paid?"已付款":"未付款"),1),e("td",We,[e("div",Ye,[e("button",{type:"button",class:"btn btn-outline-secondary border-left-0",onClick:w=>i.openModal("check",r)}," 查看 ",8,Ge),e("button",{type:"button",class:"btn btn-outline-danger",onClick:w=>i.openModal("delete",r)}," 刪除 ",8,Je)])])],2))),128))])]),h(M,{pages:t.pages,renderData:t.getOrder},null,8,["pages","renderData"])])}const st=u(Ee,[["render",Ke]]);export{st as default};
